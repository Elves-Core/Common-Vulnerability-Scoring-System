var CVSS={CVSSVersionIdentifier:"CVSS:3.0",exploitabilityCoefficient:8.22,scopeCoefficient:1.08,vectorStringRegex_30:/^CVSS:3\.0\/((AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])\/)*(AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])$/,Weight:{AV:{N:.85,A:.62,L:.55,P:.2},AC:{H:.44,L:.77},PR:{U:{N:.85,L:.62,H:.27},C:{N:.85,L:.68,H:.5}},UI:{N:.85,R:.62},S:{U:6.42,C:7.52},CIA:{N:0,L:.22,H:.56},E:{X:1,U:.91,P:.94,F:.97,H:1},RL:{X:1,O:.95,T:.96,W:.97,U:1},RC:{X:1,U:.92,R:.96,C:1},CIAR:{X:1,L:.5,M:1,H:1.5}},severityRatings:[{name:"None",bottom:0,top:0},{name:"Low",bottom:.1,top:3.9},{name:"Medium",bottom:4,top:6.9},{name:"High",bottom:7,top:8.9},{name:"Critical",bottom:9,top:10}],calculateCVSSFromMetrics:function(e,i,t,r,o,n,a,_,S,C,s,c,M,p,d,l,v,m,V,A,R,X){var h,I,g,y,H,F,b,x,T,D,u,q,k,B,N,f,L,U,P,O,E,W,w=[];return void 0!==e&&""!==e||w.push("AV"),void 0!==i&&""!==i||w.push("AC"),void 0!==t&&""!==t||w.push("PR"),void 0!==r&&""!==r||w.push("UI"),void 0!==o&&""!==o||w.push("S"),void 0!==n&&""!==n||w.push("C"),void 0!==a&&""!==a||w.push("I"),void 0!==_&&""!==_||w.push("A"),0<w.length?{success:!1,errorType:"MissingBaseMetric",errorMetrics:w}:(i=i,t=t,r=r,o=o,n=n,a=a,_=_,S=S||"X",C=C||"X",s=s||"X",c=c||"X",M=M||"X",p=p||"X",d=d||"X",l=l||"X",v=v||"X",m=m||"X",V=V||"X",A=A||"X",R=R||"X",X=X||"X",CVSS.Weight.AV.hasOwnProperty(e=e)||w.push("AV"),CVSS.Weight.AC.hasOwnProperty(i)||w.push("AC"),CVSS.Weight.PR.U.hasOwnProperty(t)||w.push("PR"),CVSS.Weight.UI.hasOwnProperty(r)||w.push("UI"),CVSS.Weight.S.hasOwnProperty(o)||w.push("S"),CVSS.Weight.CIA.hasOwnProperty(n)||w.push("C"),CVSS.Weight.CIA.hasOwnProperty(a)||w.push("I"),CVSS.Weight.CIA.hasOwnProperty(_)||w.push("A"),CVSS.Weight.E.hasOwnProperty(S)||w.push("E"),CVSS.Weight.RL.hasOwnProperty(C)||w.push("RL"),CVSS.Weight.RC.hasOwnProperty(s)||w.push("RC"),"X"===c||CVSS.Weight.CIAR.hasOwnProperty(c)||w.push("CR"),"X"===M||CVSS.Weight.CIAR.hasOwnProperty(M)||w.push("IR"),"X"===p||CVSS.Weight.CIAR.hasOwnProperty(p)||w.push("AR"),"X"===d||CVSS.Weight.AV.hasOwnProperty(d)||w.push("MAV"),"X"===l||CVSS.Weight.AC.hasOwnProperty(l)||w.push("MAC"),"X"===v||CVSS.Weight.PR.U.hasOwnProperty(v)||w.push("MPR"),"X"===m||CVSS.Weight.UI.hasOwnProperty(m)||w.push("MUI"),"X"===V||CVSS.Weight.S.hasOwnProperty(V)||w.push("MS"),"X"===A||CVSS.Weight.CIA.hasOwnProperty(A)||w.push("MC"),"X"===R||CVSS.Weight.CIA.hasOwnProperty(R)||w.push("MI"),"X"===X||CVSS.Weight.CIA.hasOwnProperty(X)||w.push("MA"),0<w.length?{success:!1,errorType:"UnknownMetricValue",errorMetrics:w}:(w=CVSS.Weight.AV[e],W=CVSS.Weight.AC[i],N=CVSS.Weight.PR[o][t],f=CVSS.Weight.UI[r],E=CVSS.Weight.S[o],L=CVSS.Weight.CIA[n],P=CVSS.Weight.CIA[a],O=CVSS.Weight.CIA[_],h=CVSS.Weight.E[S],I=CVSS.Weight.RL[C],g=CVSS.Weight.RC[s],y=CVSS.Weight.CIAR[c],H=CVSS.Weight.CIAR[M],F=CVSS.Weight.CIAR[p],b=CVSS.Weight.AV["X"!==d?d:e],x=CVSS.Weight.AC["X"!==l?l:i],T=CVSS.Weight.PR["X"!==V?V:o]["X"!==v?v:t],D=CVSS.Weight.UI["X"!==m?m:r],u=CVSS.Weight.S["X"!==V?V:o],q=CVSS.Weight.CIA["X"!==A?A:n],k=CVSS.Weight.CIA["X"!==R?R:a],B=CVSS.Weight.CIA["X"!==X?X:_],w=CVSS.exploitabilityCoefficient*w*W*N*f,W=1-(1-L)*(1-P)*(1-O),f=(N="U"===o?E*W:E*(W-.029)-3.25*Math.pow(W-.02,15))<=0?0:"U"===o?CVSS.roundUp1(Math.min(w+N,10)):CVSS.roundUp1(Math.min((w+N)*CVSS.scopeCoefficient,10)),L=CVSS.roundUp1(f*h*I*g),P=CVSS.exploitabilityCoefficient*b*x*T*D,O=Math.min(1-(1-q*y)*(1-k*H)*(1-B*F),.915),E="U"===V||"X"===V&&"U"===o?(U=u*O,CVSS.roundUp1(CVSS.roundUp1(Math.min(U+P,10))*h*I*g)):(U=u*(O-.029)-3.25*Math.pow(O-.02,15),CVSS.roundUp1(CVSS.roundUp1(Math.min(CVSS.scopeCoefficient*(U+P),10))*h*I*g)),U<=0&&(E=0),W=CVSS.CVSSVersionIdentifier+"/AV:"+e+"/AC:"+i+"/PR:"+t+"/UI:"+r+"/S:"+o+"/C:"+n+"/I:"+a+"/A:"+_,"X"!==S&&(W=W+"/E:"+S),"X"!==C&&(W=W+"/RL:"+C),"X"!==s&&(W=W+"/RC:"+s),"X"!==c&&(W=W+"/CR:"+c),"X"!==M&&(W=W+"/IR:"+M),"X"!==p&&(W=W+"/AR:"+p),"X"!==d&&(W=W+"/MAV:"+d),"X"!==l&&(W=W+"/MAC:"+l),"X"!==v&&(W=W+"/MPR:"+v),"X"!==m&&(W=W+"/MUI:"+m),"X"!==V&&(W=W+"/MS:"+V),"X"!==A&&(W=W+"/MC:"+A),"X"!==R&&(W=W+"/MI:"+R),"X"!==X&&(W=W+"/MA:"+X),{success:!0,baseMetricScore:f.toFixed(1),baseSeverity:CVSS.severityRating(f.toFixed(1)),temporalMetricScore:L.toFixed(1),temporalSeverity:CVSS.severityRating(L.toFixed(1)),environmentalMetricScore:E.toFixed(1),environmentalSeverity:CVSS.severityRating(E.toFixed(1)),vectorString:W}))},calculateCVSSFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS.vectorStringRegex_30.test(e))return{success:!1,errorType:"MalformedVectorString"};var r,o,n=e.substring(CVSS.CVSSVersionIdentifier.length).split("/");for(r in n)n.hasOwnProperty(r)&&(void 0===i[(o=n[r].split(":"))[0]]?i[o[0]]=o[1]:t.push(o[0]));return 0<t.length?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS.calculateCVSSFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)},roundUp1:function(e){return Math.ceil(10*e)/10},severityRating:function(e){var i=CVSS.severityRatings.length,t=Number(e);if(isNaN(t))return t;for(var r=0;r<i;r++)if(e>=CVSS.severityRatings[r].bottom&&e<=CVSS.severityRatings[r].top)return CVSS.severityRatings[r].name},XML_MetricNames:{E:{X:"NOT_DEFINED",U:"UNPROVEN",P:"PROOF_OF_CONCEPT",F:"FUNCTIONAL",H:"HIGH"},RL:{X:"NOT_DEFINED",O:"OFFICIAL_FIX",T:"TEMPORARY_FIX",W:"WORKAROUND",U:"UNAVAILABLE"},RC:{X:"NOT_DEFINED",U:"UNKNOWN",R:"REASONABLE",C:"CONFIRMED"},CIAR:{X:"NOT_DEFINED",L:"LOW",M:"MEDIUM",H:"HIGH"},MAV:{N:"NETWORK",A:"ADJACENT_NETWORK",L:"LOCAL",P:"PHYSICAL",X:"NOT_DEFINED"},MAC:{H:"HIGH",L:"LOW",X:"NOT_DEFINED"},MPR:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"},MUI:{N:"NONE",R:"REQUIRED",X:"NOT_DEFINED"},MS:{U:"UNCHANGED",C:"CHANGED",X:"NOT_DEFINED"},MCIA:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"}},generateXMLFromMetrics:function(e,i,t,r,o,n,a,_,S,C,s,c,M,p,d,l,v,m,V,A,R,X){var h=CVSS.calculateCVSSFromMetrics(e,i,t,r,o,n,a,_,S,C,s,c,M,p,d,l,v,m,V,A,R,X);return!0!==h.success?h:{success:!0,xmlString:'<?xml version="1.0" encoding="UTF-8"?>\n<cvssv3.0 xmlns="https://www.first.org/cvss/cvss-v3.0.xsd"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="https://www.first.org/cvss/cvss-v3.0.xsd https://www.first.org/cvss/cvss-v3.0.xsd"\n  >\n\n  <base_metrics>\n    <attack-vector>__AttackVector__</attack-vector>\n    <attack-complexity>__AttackComplexity__</attack-complexity>\n    <privileges-required>__PrivilegesRequired__</privileges-required>\n    <user-interaction>__UserInteraction__</user-interaction>\n    <scope>__Scope__</scope>\n    <confidentiality-impact>__Confidentiality__</confidentiality-impact>\n    <integrity-impact>__Integrity__</integrity-impact>\n    <availability-impact>__Availability__</availability-impact>\n    <base-score>__BaseScore__</base-score>\n    <base-severity>__BaseSeverityRating__</base-severity>\n  </base_metrics>\n\n  <temporal_metrics>\n    <exploit-code-maturity>__ExploitCodeMaturity__</exploit-code-maturity>\n    <remediation-level>__RemediationLevel__</remediation-level>\n    <report-confidence>__ReportConfidence__</report-confidence>\n    <temporal-score>__TemporalScore__</temporal-score>\n    <temporal-severity>__TemporalSeverityRating__</temporal-severity>\n  </temporal_metrics>\n\n  <environmental_metrics>\n    <confidentiality-requirement>__ConfidentialityRequirement__</confidentiality-requirement>\n    <integrity-requirement>__IntegrityRequirement__</integrity-requirement>\n    <availability-requirement>__AvailabilityRequirement__</availability-requirement>\n    <modified-attack-vector>__ModifiedAttackVector__</modified-attack-vector>\n    <modified-attack-complexity>__ModifiedAttackComplexity__</modified-attack-complexity>\n    <modified-privileges-required>__ModifiedPrivilegesRequired__</modified-privileges-required>\n    <modified-user-interaction>__ModifiedUserInteraction__</modified-user-interaction>\n    <modified-scope>__ModifiedScope__</modified-scope>\n    <modified-confidentiality-impact>__ModifiedConfidentiality__</modified-confidentiality-impact>\n    <modified-integrity-impact>__ModifiedIntegrity__</modified-integrity-impact>\n    <modified-availability-impact>__ModifiedAvailability__</modified-availability-impact>\n    <environmental-score>__EnvironmentalScore__</environmental-score>\n    <environmental-severity>__EnvironmentalSeverityRating__</environmental-severity>\n  </environmental_metrics>\n\n</cvssv3.0>\n'.replace("__AttackVector__",CVSS.XML_MetricNames.MAV[e]).replace("__AttackComplexity__",CVSS.XML_MetricNames.MAC[i]).replace("__PrivilegesRequired__",CVSS.XML_MetricNames.MPR[t]).replace("__UserInteraction__",CVSS.XML_MetricNames.MUI[r]).replace("__Scope__",CVSS.XML_MetricNames.MS[o]).replace("__Confidentiality__",CVSS.XML_MetricNames.MCIA[n]).replace("__Integrity__",CVSS.XML_MetricNames.MCIA[a]).replace("__Availability__",CVSS.XML_MetricNames.MCIA[_]).replace("__BaseScore__",h.baseMetricScore).replace("__BaseSeverityRating__",h.baseSeverity).replace("__ExploitCodeMaturity__",CVSS.XML_MetricNames.E[S||"X"]).replace("__RemediationLevel__",CVSS.XML_MetricNames.RL[C||"X"]).replace("__ReportConfidence__",CVSS.XML_MetricNames.RC[s||"X"]).replace("__TemporalScore__",h.temporalMetricScore).replace("__TemporalSeverityRating__",h.temporalSeverity).replace("__ConfidentialityRequirement__",CVSS.XML_MetricNames.CIAR[c||"X"]).replace("__IntegrityRequirement__",CVSS.XML_MetricNames.CIAR[M||"X"]).replace("__AvailabilityRequirement__",CVSS.XML_MetricNames.CIAR[p||"X"]).replace("__ModifiedAttackVector__",CVSS.XML_MetricNames.MAV[d||"X"]).replace("__ModifiedAttackComplexity__",CVSS.XML_MetricNames.MAC[l||"X"]).replace("__ModifiedPrivilegesRequired__",CVSS.XML_MetricNames.MPR[v||"X"]).replace("__ModifiedUserInteraction__",CVSS.XML_MetricNames.MUI[m||"X"]).replace("__ModifiedScope__",CVSS.XML_MetricNames.MS[V||"X"]).replace("__ModifiedConfidentiality__",CVSS.XML_MetricNames.MCIA[A||"X"]).replace("__ModifiedIntegrity__",CVSS.XML_MetricNames.MCIA[R||"X"]).replace("__ModifiedAvailability__",CVSS.XML_MetricNames.MCIA[X||"X"]).replace("__EnvironmentalScore__",h.environmentalMetricScore).replace("__EnvironmentalSeverityRating__",h.environmentalSeverity)}},generateXMLFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS.vectorStringRegex_30.test(e))return{success:!1,errorType:"MalformedVectorString"};var r,o,n=e.substring(CVSS.CVSSVersionIdentifier.length).split("/");for(r in n)n.hasOwnProperty(r)&&(void 0===i[(o=n[r].split(":"))[0]]?i[o[0]]=o[1]:t.push(o[0]));return 0<t.length?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS.generateXMLFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)}};
